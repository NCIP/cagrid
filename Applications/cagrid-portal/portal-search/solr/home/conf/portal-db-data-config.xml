<dataConfig>
    <dataSource driver="com.mysql.jdbc.Driver" url="@cagrid.portal.db.url@"
                user="@cagrid.portal.db.username@" password="@cagrid.portal.db.password@"/>

    <document name="CatalogEntry">


        <entity name="AllCatalogs"
                query="select * from cat_entry"
                deltaImportQuery="select * from cat_entry where id=='${dataimporter.delta.id}'"
                deltaQuery="select id from cat_entry where where updatedAt > '${dataimporter.last_index_time}'">
            <field column="id" name="id"/>
            <field column="catalog_type" name="catalog_type"/>
            <field column="name" name="catalogName"/>
            <field column="firstName" name="firstName"/>
            <field column="lastName" name="lastName"/>
            <field column="description" name="description"/>
            <field column="street1" name="street1"/>
            <field column="locality" name="locality"/>
            <field column="stateProvince" name="stateProvince"/>
            <field column="country" name="country"/>
            <field column="homepageUrl" name="homepageUrl"/>
            <field column="phoneNumber" name="phoneNumber"/>
            <field column="updatedAt" name="updatedAt"/>
            <field column="featured" name="featured"/>

            <!--<entity name="Hyperlink"-->
            <!--query="select * from cat_hyperlinks where catalog_id='${AllCatalogs.id}'">-->
            <!--<field name="homepageUrl" column="url"/>-->
            <!--</entity>-->
            <entity name="GridService"
                    query="select * from grid_services where id='${AllCatalogs.grid_service_id}'">
                <field name="endpoint" column="url"/>
            </entity>
            <entity name="AreaOfFocusTerm"
                    query="select term_id from cat_entry_aofterms where entry_id='${AllCatalogs.id}'">
                <entity name="term"
                        query="select * from cat_terms where id='${AreaOfFocusTerm.term_id}'">
                    <field name="term_description" column="description"/>
                    <field name="term_identifier" column="identifier"/>
                    <field name="term_label" column="label"/>
                </entity>
            </entity>
            <entity name="ratings"
                    query="select id from cat_ratings where catalog_id='${AllCatalogs.id}'">
                <field name="rating" column="rating"/>
                <field name="createdAt" column="createdAt"/>
                <field name="updatedAt" column="updatedAt"/>
            </entity>
        </entity>


    </document>

</dataConfig>
